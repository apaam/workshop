### Linux 文件系统结构及管理

在Linux系统中，没有像Windows系统那样的磁盘分区，其文件系统均需挂载到特定的目录才能使用，并使用mount工具对文件系统进行挂载。Linux的文件系统主要有ext2、ext3、ext4和reiserfs等，并支持其他多种文件系统。Linux文件系统的结构实现为一种分层的体系结构，将用户接口层、文件系统实现和存储设备的驱动程序分隔开来。

以Ubuntu Linux系统为例，它采用ext3文件系统，一切文件均以目录的形式存储，在根目录下既可以是目录，也可以是文件，且每一个目录中又可以包含子目录或文件。Ubuntu系统具有如图1所示的树状目录结构。也可在终端的根目录下利用`ls`命令查看根目录下的文件及文件夹信息。

图1中，“/”为系统根目录，根目录下各文件夹具有不同的功能，具体为:

`/bin/`: bin 是 binaries 的缩写，存放常用的二进制可执行命令文件。
`/boot/`: 存放 Ubuntu 内核和系统启动文件，包括连接文件和镜像文件。
`/dev/`: dev 是 device 的缩写，存放 Linux 外部设备文件。
`/etc/`: 存放系统管理所需的配置文件和子目录。
`home/`: 用户主目录，每个用户在该目录下均有一个以用户名命名的子目录。
`/lib/`: lib 是 library 的缩写，存放程序所需的共享库文件，这些库文件主要为`/bin/`和`/sbin/`目录下的可执行文件服务。
`/media/`: 挂载 Ubuntu 系统自动识别设备的设备文件。
`/mnt/`: 用于临时挂载其他文件系统。
`/opt/`: opt是optional的缩写，安装软件的可选文件和程序的存放目录。
`/proc/`: proc是processes 的缩写，一个虚拟目录，目录内容位于内存而不是硬盘，是内存的映射，内容包括系统信息和进程信息。
`/root/`: 系统管理员用户主目录，或超级权限者用户主目录
`/run/`: 临时文件系统，存储系统启动以来的信息，当系统重启时，该目录下的文件会被删除
`/sbin/`: sbin 是 supenuser binaries 的缩写，存放系统管理员使用的系统命令。
`/snap/`: 存放某一个时间点系统的备份。
`/srv/`: 存放系统服务启动后的提取数据。
`/sys/`: 一个虚拟文件系统，存放当前系统上硬件设备相关信息
`/tmp/`: tmp 是 temporary 的缩写，存放用户和系统的临时文件。
`/usr/`: usr 是 Unix shared resources 的缩写，存放用户的应用程序和文件，类似于 Windows系统下的 program files 文件夹。
`/var/`: var 是 variable 的缩写，存放各种肉容不断变化的文件，如各种日志文件.
`/init/`: Linux 系统的进程初始化工具。

在Windows 10操作系统上安装的内置Linux子系统也具有与图1类似的文件系统目录结构。

在Linux终端使用Shell命令可以非常高效地对文件系统进行管理，常用的文件系统Shell管理命令见表1。

<center>
表1-5 Linux 常用文件系统管理 Shell 命令
</center>

|名称和语法|功能|选项说明|
|:---:|:---:|:---|
|`touch [参数][文件名]`|创建新文件。如果该文件已经存在，则修改源文件的修改曰期|`-a`:只更改存取时间 <br> `-c`:不建立任何文件 <br> `-d <时间日期>`:使用指定时间 <br> `-m`:只更改变动时间 <br> `-r<参考文件或目录>`:将指定文件或目录的时间设置为参考文件或目录的时间 <br> `-t <日期时间>`:使用指定时间 <br> `--help`:在线帮助 <br> `--version`:显示版本信息
|`cp[参数] [源地址] [目标地址]`|复制文件或目录|`-a`:与`-dpR`的组合效果相同 <br> `-d`:复制符号连接时保留原始连接 <br> `-f`:强行复制，不管目标是否存在 <br> `-I`:覆盖已有文件时需询问 <br> `-l`:建立源文件的硬连接 <br> `-p`:复制文件内容的同时保留修改时间和访问权限等信息 <br> `-P`:保留源文件或目录的路径 <br> `-r`:将指定目录下的文件与子目录一并复制 <br> `-R`:将指定目录下的所有内容一并复制 <br> `-s`:对源文件建立符号连接 <br> `-v`:显示指令执行过程|
|`mv [参数][源地址][目标地址]`|更改文件或目录名称，移动文件或目录|`-b`:若需覆盖文件，覆盖前需询问 <br> `-f`:若目标地址处已存在相同文件或目录，直接覆盖 <br> `-l`:覆盖前需询问 <br> `-v`:显示指令执行过程|
|`rm [参数][目标地址]`|删除文件或目录，对于链接文件，只删除链接|`-d`:删除目录的硬连接数据和目录 <br> `-f`:强制删除文件或目录 <br> `-i`:删除前逐一询问确认 <br> `-r`:删除指定目录下的所有文件和子目录（删除目录时必须使用） <br> `-v`:显示指令执行过程|
|`mkdir [参数][日录名]`|创建一个目录|`-p`:若所要建立目录的上级目录尚未建立，则一并建立上级目录|
|`rmdir [参数][目的地址]`|删除一个目录|`-p`:若指定目录的上级目录在该目录被删删除一个目录除后成为空目录，一并删除上级目录|
|`more [参数][文件名]`|在终端界面按屏显示文件内容。按Enter键显示下一行，按Space键显示下一屏，按Q键退出显示模式|`-p`:显示下一屏前清屏 <br> `-d`:在每一屏的底部显示操作提示 <br> `-s`:显示时将连续的空白行压缩为一行 <br> `-num`:要求每屏显示的行数，使用时num用数字代替|
|`less [参数][文件名]`| more功能相同，但使用less允许使用上下键翻阅|(与more的参数相同，也可以使用按键J和K导航，按Q键退出)|
|`head [参数][文件名]`| 只显示文件的前面几行或前面几个字节的内容| `-num`:要求显示的行数，默认10行 <br> `-cnum`:显示前num个字节的内容|
|`tail [参数][文件名]`|只显示文件的最后几行或最后几个字节的内容|`-num`:要求显示的行数，默认10行 <br> `-cnum`:显示后num个字节的内容|
|`file [参数][文件名]`|显示文件类型|`-b`:显示结果是不包括文件名称 <br> `-c`:显示指令执行过程 <br> `-L`:显示符号连接所指向文件类别 <br> `-v`:显示版本信息|
|`ln [参数][目的地址][链接文件名]`|创建链接文件|`-b`:覆盖目标文件之前的备份 <br> `-d`:建立目录的硬链接 <br> `-f`:强行建立文件或目录的链接 <br> `-i`:覆盖文件前需询问 <br> `-n`:视链接文件为一般文件 <br> `-s`:建立符号链接|
|`wc [参数][文件名]`|统计文件中的字数、字节数等信息|`-c`:只统计字节数 <br> `-l`:只统计行数 <br> `-w`:只统计字数|
|`tee [参数][文件名]`|从标准设备读取数据，或输出至标准设备|`-a` 或 `-append`:附加到既有文件的后面而非覆盖它 <br> `-i` 或`--ignore-interrupts`:忽略中断信号 <br> `--help`:在线帮助|
|`comm [参数] [文件1] [文件2]`|逐行比较两个已排序文件的差异|`-1`:不显示文件1特有的行文 <br> `-2`:不显示文件2特有的行文 <br> `-3`:不显示两个文件共有的行文|
|`diff [参数] [文件1] [文件2]`|逐行比较文本文件的异同。如果是指定目录，则只比较其中相同文件名的文件|`-i`:忽略文件内容中的大小写<br> `-E`:忽略Tab扩展导致的差别 <br> `-b`:忽略空格字符的不同 <br> `-w`:忽略所有空白 <br> `-B`:不检查空白行 <br> `-a-text`:将所有文件作为文本处理|
|`zip [参数] [压缩文件名zip] [被压缩文件列表]`|将被压缩文件列表指定的文件压缩为一个.zip文件|`-b<目录>`:指定暂时存放文件的目录 <br> `-d`:从压缩文件内删除指定文件 <br> `-F`:修复已损坏的压缩文件 <br> `-g`:文件压缩后附加在既有压缩文件之后 <br> `-h`:帮助 <br> `-j`:只保存文件名称及其内容面不存放目录名称 <br> `-m`:压缩后删除原始文件 <br> `-n <字尾字符串>`:不压缩指定字尾的文件 <br> `-q`:不显示指令执行过程 <br> `-r`:将指定目录下的所有文件和子目录全部处理 <br> `-S`:包含系统和隐藏文件 <br> `-t <时间>`:设置压缩文件时间 <br> `-u`:更新压缩文件内的文件 <br> `-v`:显示执行过程或版本信息 <br> `-x <范本>`:排除符合条件的文件 <br> `-y`:直接保存符号链接，而不是该链接指向的文件 <br> `-z`:为压缩文件增加注释 <br> `-$`:保存第一个被乐缩文件所在磁盘的卷册名称 <br> `-num`:指定压缩效率|
|`unzip [参数] [压缩文件名.zip]`|解压缩.zip文件|`-l`:显示压缩文件内所包含的文件 <br> `-t`:检查压缩文件是否正确 <br> `-v`:显示执行过程 <br> `-z`:仅显示乐缩文件的备注文字 <br> `-C`:解压后的文件名区分大小写 <br> `-j`:不处理压缩文件中原有目录路径 <br> `-L`:解压后的文件名全部改为小写 <br> `-n`:解压时不覆盖原有文件 <br> `-P <密码>`:使用 zip 密码选项 <br> `-q`:不显示执行过程 <br> `-d <目录>`:指定解压后的存储目录 <br> `-x <文件>`:指定不解压的文件 <br> `-Z`:显示压缩包中的文件信息，不解压|

与 Windows 系统类似，Linux 文件系统中也包括不同类型的文件，在显示文件详细信息时用不同的符号表示，主要有:
`-`:普通文件，通常为由应用程序创建的文件。
`d`:目录，可以包含多个文件或子目录。
`c`:字符设备、串口设备，如调制解调器等。
`b`:块设备，存储数据供系统存取的接口设备，如硬盘、光驱等。
`l`:符号链接文件，相当于快捷方式，指向目标文件。
`s`:套接口文件，用于网络通信。
`p`:管道文件，主要为FIFO 文件。

这里的文件链接相当于创建文件的快捷方式，Linux 系统中有两种类型的文件链接——硬链接和软链接，其中软链接也称为符号链接。硬链接利用 Linux 为每个文件分配的物理编号建立，修改硬链接的目标文件名后，链接依然有效。软链接的建立则依赖于文件的路径名，修改链接的目标文件名后链接将断开。对链接文件进行移动或删除操作可能会导致链接断开。如果删除已有目标文件，重新建立一个同名文件时，软链接将恢复，而硬链接将失效。

在终端中使用Is-命令可以査看文件的详细信息，例如，查看 OpenFOAM 安装文件夹后的显示内容及含义如图 1-2 所示。其中字符串“rwxr-xr-x”每3位一组，分别表示文件所属用户的权限、所属用户组的权限和其他用户组的权限，r表示可读，w表示可写，x表示可执行
```sudo su```
进入 root 用户，在输入密码后可打开一个 root 权限的终端，执行完毕后从 root 用户回到原先用户可使用
```exit```
命令，也可使用该命令退出终端窗口。

<center>
表1-6 Linux 用户、用户组及其权限管理常用 Shell 命令
</center>

|名称和语法|功能|选项说明|
|:---:|:---:|:---|
|`whoami`|显示当前用户名||
|`adduser [参数] [用户名]`|添加用户|`--system`:添加一个系统用户 <br> `--home DIR`: DIR 表示的主目录路径 <br> `--shell SHELL` : SHELL 表示用户的默认 SHELU <br> `--uid ID`: ID 表示用户的 uid <br> `--ingroup GRP`: GRP 表示用户所述用户组 <br> `--help`: 帮助|
|`finger [参数] [用户名]`|查找用户信息|`-l`:列出用户的账号名称、姓名等信息 <br> `-m`:不显示所查找用户的姓名 <br> `-s`:查找用户的账号名称、姓名、登录主机等信息 <br> `-p`:查找用户的账号名称、姓名、专属目录等信息|
|`passwd [参数] [用户名]`|更改用户密码。系统管理员用户可以更改所有用户的密码|`-d`: 删除用户密码，密码置空 <br> `-l`:锁定用户，只有系统管理员可用 <br> `-u`:解锁用户，只有系统管理员可用 <br> `-m -mindays DAYS`: 密码使用的最短天数 <br> `-m -maxdays DAYS`: 密码使用的最长天数|
|`usermod [参数] [用户名]`|修改用户登录信息|`-d`: 修改用户登录时的主目录 <br> `-e <有效期限>`: 修改账号有效期 <br> `-f <天数>`: 密码过期指定天后关闭账号 <br> `-g<组>`: 修改用户所属组 <br> `-G<组>`:修改用户所述附加组 <br> `-l <账号名>`:修改用户账号名 <br> `-L`:锁定用户密码，使其无效 <br> `-s`:修改用户使用的 Shell <br> `-u`:修改用户ID <br> `-U`:解除密码锁定|
|`id [参数] [用户名]`|显示用户的 ID 识别号|`-g`:显示用户所属组的ID <br> `-G`:显示用户所属附加组的ID <br> `-r`:显示实际 ID <br> `-u`:显示用户JD|
|`chfn [参数] [用户名]`|修改用户基本信息|`-f <姓名>`:修改用户姓名 <br> `-h <家庭电话>`:修改家庭电话 <br> `-r <房间号>`:修改用户地址 <br> `-w <办公电话>`:修改办公电话|
|`deluser [参数] [用户名]`|删除用户|`--system`:只删除系统用户 <br> `--remove-home`:删除用户主目录 <br> `--remove-all-files`:删除所有有关文件 <br> `--backup`:备份用户信息|
|`addgroup [参数] [用户组名]`|添加用户组|`--gid`:指定用户组ID <br> `--system`:添加一个系统用户组|
|`Groups[用户组名]`|显示组内用户||
|`groupmod [参数] [用户组名]`|修改用户组信息|`-g <GID>`:设置用户组识别码 <br> `-o`:重复使用组识别码 <br> `-n <name>`:更改组名称|
|`delgroup [参数] [用户组名]`|删除用户组|`-only-ir-emty`:仅当所要删除的用户组内没有用户时才删除|
|`chmod [参数] [文件名/目录名]`|修改文件或文件夹的权限|`-v`:显示指令执行过程 <br> `-c`:类似于`-v`，值显示更改部分修改文件或文件夹 <br> `-f`:不显示错误信息的权限 <br>`-R`:将指定目录下的所有文件和子目录全部处理|
|`chown [参数] [用户名<组名>] [文件名/目录]`|修改文件或目录所属用户或组|`-v`:显示指令执行过程 <br> `-c`:类似于 `-v`，值显示更改部分 <br> `-f`:不显示错误信息 <br> `-h`:只更改符号链接文件 <br> `-R`:将指定目录下的所有文件和子目录全部处理|
|`chgrp [参数] [组名] [文件/目录名]`|修改文件或目录的所属组|（与 chown 命令的参数内容及含义相同）|
|`du [参数] [目录或文件名]`|显示文件或目录的大小|`-a`:显示目录中个别文件的大小 <br> `-b`:显示的大小以 byte 为单位 <br> `-c`:除显示个别目录或文件大小外，还显示所有目录或文件的大小综合 <br> `-h`:以 KB、MB、GB 为单位 <br> `-k`:以 1024bytes 为单位 <br> `-m`:以 MB 为单位 <br> `-s`:仅显示总大小|